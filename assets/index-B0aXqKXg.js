import{j as a,k as j,P as y,r as n,a as g,b as C,c as m,d as h,C as N}from"./index-kaEL3jBi.js";import{G as k}from"./GPS-dPaiC2-K.js";import{D as z}from"./index-B8Aalygw.js";import{u as A,L as K}from"./useFetch-G5E5aif_.js";import{a as M}from"./index-BC6G4Pvj.js";const w="/taiwan_bus/assets/Bus-CdMhyZ1O.mp3",B="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='30'%20height='30'%20fill='currentColor'%20class='bi%20bi-keyboard-fill'%20viewBox='0%200%2016%2016'%3e%3cpath%20d='M0%206a2%202%200%200%201%202-2h12a2%202%200%200%201%202%202v5a2%202%200%200%201-2%202H2a2%202%200%200%201-2-2V6zm13%20.25v.5c0%20.138.112.25.25.25h.5a.25.25%200%200%200%20.25-.25v-.5a.25.25%200%200%200-.25-.25h-.5a.25.25%200%200%200-.25.25zM2.25%208a.25.25%200%200%200-.25.25v.5c0%20.138.112.25.25.25h.5A.25.25%200%200%200%203%208.75v-.5A.25.25%200%200%200%202.75%208h-.5zM4%208.25v.5c0%20.138.112.25.25.25h.5A.25.25%200%200%200%205%208.75v-.5A.25.25%200%200%200%204.75%208h-.5a.25.25%200%200%200-.25.25zM6.25%208a.25.25%200%200%200-.25.25v.5c0%20.138.112.25.25.25h.5A.25.25%200%200%200%207%208.75v-.5A.25.25%200%200%200%206.75%208h-.5zM8%208.25v.5c0%20.138.112.25.25.25h.5A.25.25%200%200%200%209%208.75v-.5A.25.25%200%200%200%208.75%208h-.5a.25.25%200%200%200-.25.25zM13.25%208a.25.25%200%200%200-.25.25v.5c0%20.138.112.25.25.25h.5a.25.25%200%200%200%20.25-.25v-.5a.25.25%200%200%200-.25-.25h-.5zm0%202a.25.25%200%200%200-.25.25v.5c0%20.138.112.25.25.25h.5a.25.25%200%200%200%20.25-.25v-.5a.25.25%200%200%200-.25-.25h-.5zm-3-2a.25.25%200%200%200-.25.25v.5c0%20.138.112.25.25.25h1.5a.25.25%200%200%200%20.25-.25v-.5a.25.25%200%200%200-.25-.25h-1.5zm.75%202.25v.5c0%20.138.112.25.25.25h.5a.25.25%200%200%200%20.25-.25v-.5a.25.25%200%200%200-.25-.25h-.5a.25.25%200%200%200-.25.25zM11.25%206a.25.25%200%200%200-.25.25v.5c0%20.138.112.25.25.25h.5a.25.25%200%200%200%20.25-.25v-.5a.25.25%200%200%200-.25-.25h-.5zM9%206.25v.5c0%20.138.112.25.25.25h.5a.25.25%200%200%200%20.25-.25v-.5A.25.25%200%200%200%209.75%206h-.5a.25.25%200%200%200-.25.25zM7.25%206a.25.25%200%200%200-.25.25v.5c0%20.138.112.25.25.25h.5A.25.25%200%200%200%208%206.75v-.5A.25.25%200%200%200%207.75%206h-.5zM5%206.25v.5c0%20.138.112.25.25.25h.5A.25.25%200%200%200%206%206.75v-.5A.25.25%200%200%200%205.75%206h-.5a.25.25%200%200%200-.25.25zM2.25%206a.25.25%200%200%200-.25.25v.5c0%20.138.112.25.25.25h1.5A.25.25%200%200%200%204%206.75v-.5A.25.25%200%200%200%203.75%206h-1.5zM2%2010.25v.5c0%20.138.112.25.25.25h.5a.25.25%200%200%200%20.25-.25v-.5a.25.25%200%200%200-.25-.25h-.5a.25.25%200%200%200-.25.25zM4.25%2010a.25.25%200%200%200-.25.25v.5c0%20.138.112.25.25.25h5.5a.25.25%200%200%200%20.25-.25v-.5a.25.25%200%200%200-.25-.25h-5.5z'%20fill='%231CC8EE'/%3e%3c/svg%3e";function v({city:t}){return a.jsxs("div",{className:"keyboard bg-gray p-6",children:[a.jsxs("label",{htmlFor:"cityKeyboard",className:"btn btn-light city-btn","aria-label":"選擇縣市",children:[a.jsx(k,{})," ",t||"選擇縣市"]}),a.jsx("label",{htmlFor:"search",className:"btn btn-primary manual-btn","aria-label":"手動輸入",children:"手動輸入"}),j.map(e=>e!=="更多"?a.jsx("button",{type:"button",className:`btn ${e==="倒退"?"delete-icon p-1":Number.isInteger(e)?"btn-light":"btn-primary"}`,"aria-label":e,"data-route":e,children:e==="倒退"?null:e},e):a.jsx("label",{htmlFor:"moreKeyboard",className:"btn btn-primary","aria-label":e,children:e},e))]})}v.propTypes={city:y.string};function x({city:t,setCity:e}){const[r,o]=n.useState(t||""),c=s=>{const{city:i,savecity:b,node:u}=s.target.dataset;switch(u){case"setCity":o(i);break;case"saveCity":e(b);break}};return a.jsxs("div",{className:"keyboard bg-gray p-6",onClick:c,children:[g.map(s=>a.jsx("button",{type:"button",className:`btn btn-primary fs-3 p-0 ${r===s.CityName?"active":""}`,"aria-label":s.CityName+" "+s.City,"data-city":s.CityName,"data-node":"setCity",children:s.CityName},s.City)),a.jsx("label",{htmlFor:"baseKeyboard",className:"btn btn-primary fs-3 enter-btn","aria-label":"設定","data-savecity":r,"data-node":"saveCity",children:"設定"})]})}x.propTypes={setCity:y.func.isRequired,city:y.string};function F(){return a.jsxs("div",{className:"keyboard bg-gray p-6",children:[C.map(t=>a.jsx("button",{type:"button",className:"btn btn-primary fs-3 p-0","aria-label":t,"data-route":t,children:t},t)),a.jsx("label",{htmlFor:"baseKeyboard",className:"btn btn-primary fs-3 goBack-btn","aria-label":"回上一頁",children:"回上一頁"})]})}const d={type:"radio",className:"d-none",name:"keyboard"};function R(){const{city:t,setCity:e}=n.useContext(m),r=n.useRef(null),o=c=>{const{route:s}=c.target.dataset;r.current.currentTime=0,r.current.play(),h.publish("search",s||"")};return a.jsxs("div",{className:"keyboard-frame position-relative",onClick:o,children:[a.jsx("input",{...d,id:"moreKeyboard"}),a.jsx(F,{}),a.jsx("input",{...d,id:"cityKeyboard",defaultChecked:!t}),a.jsx(x,{city:t,setCity:e}),a.jsx("input",{...d,id:"baseKeyboard",defaultChecked:t}),a.jsx(v,{city:t}),a.jsx("label",{htmlFor:"baseKeyboard",className:"position-absolute bottom-0 end-0 text-primary bg-gray me-2 rounded keyboard-show-btn","aria-label":"鍵盤 Keyboard",children:a.jsx("img",{src:B,className:"px-4 py-2",alt:"鍵盤 Keyboard"})}),a.jsx("audio",{ref:r,children:a.jsx("source",{type:"audio/mpeg",src:w})})]})}function G(){var p;const t=n.useRef(null),e=()=>{t.current.checked=!0};n.useEffect(()=>{const l=h.subscribe("focus",()=>{e()});return()=>{h.unsubscribe(l)}},[]);const{city:r,city_En:o,keyword:c}=n.useContext(m),s=n.useCallback(()=>M(o),[o]),{data:i,loading:b}=A(s),f=(Array.isArray(i)?(p=i.filter)==null?void 0:p.call(i,l=>(l==null?void 0:l.RouteName.Zh_tw.indexOf(c))!==-1):[]).slice(50);return a.jsxs(a.Fragment,{children:[a.jsx(N,{className:"content",children:c.trim()===""?a.jsxs(a.Fragment,{children:[a.jsx("h2",{className:"fs-2 pt-7 mb-1",children:r||"請選擇縣市"}),a.jsx("div",{className:"fs-3",children:"選擇路線或手動輸入關鍵字～"})]}):b?a.jsx(K,{}):a.jsx(z,{setShow:e,title:r,data:f})}),a.jsx("input",{type:"radio",className:"d-none",name:"keyboard",id:"noKeyboard",ref:t}),a.jsx(R,{})]})}export{G as default};
